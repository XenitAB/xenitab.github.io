<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Designing RESTful APIs for cloud services | Xenit</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="http://xenitab.github.io/img/Xenit_logo_Svart.png"><meta data-rh="true" name="twitter:image" content="http://xenitab.github.io/img/Xenit_logo_Svart.png"><meta data-rh="true" property="og:url" content="http://xenitab.github.io/blog/2022/04/25/designing-restful-apis-for-cloud-services"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Designing RESTful APIs for cloud services | Xenit"><meta data-rh="true" name="description" content="This blog post provides guidelines for RESTful APIs for software-as-a-service offerings, with the goal to maximize their life span and support rapid evolution throughout it.
"><meta data-rh="true" property="og:description" content="This blog post provides guidelines for RESTful APIs for software-as-a-service offerings, with the goal to maximize their life span and support rapid evolution throughout it.
"><meta data-rh="true" name="keywords" content="api,rest,architecture"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-04-25T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/bittrance"><meta data-rh="true" property="article:tag" content="api,rest,architecture"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="http://xenitab.github.io/blog/2022/04/25/designing-restful-apis-for-cloud-services"><link data-rh="true" rel="alternate" href="http://xenitab.github.io/blog/2022/04/25/designing-restful-apis-for-cloud-services" hreflang="en"><link data-rh="true" rel="alternate" href="http://xenitab.github.io/blog/2022/04/25/designing-restful-apis-for-cloud-services" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"http://xenitab.github.io/blog/2022/04/25/designing-restful-apis-for-cloud-services","mainEntityOfPage":"http://xenitab.github.io/blog/2022/04/25/designing-restful-apis-for-cloud-services","url":"http://xenitab.github.io/blog/2022/04/25/designing-restful-apis-for-cloud-services","headline":"Designing RESTful APIs for cloud services","name":"Designing RESTful APIs for cloud services","description":"This blog post provides guidelines for RESTful APIs for software-as-a-service offerings, with the goal to maximize their life span and support rapid evolution throughout it.\n","datePublished":"2022-04-25T00:00:00.000Z","author":{"@type":"Person","name":"Anders Qvist","description":"Expert Engineer","url":"https://github.com/bittrance","email":"anders.qvist@xenit.se","image":"https://media-exp1.licdn.com/dms/image/C5603AQETsc7IPBMeZg/profile-displayphoto-shrink_800_800/0/1516275947412?e=1673481600&v=beta&t=zo3AriMbbg_yN4uAFtsvkSL3aPaGiOl5UZLbCa53WV4"},"keywords":["api","rest","architecture"],"isPartOf":{"@type":"Blog","@id":"http://xenitab.github.io/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Xenit RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Xenit Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=GTM-5K3TQ3K"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","GTM-5K3TQ3K",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.835dd407.css">
<script src="/assets/js/runtime~main.3e176847.js" defer="defer"></script>
<script src="/assets/js/main.50de46a3.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/Xenit_logo_Svart.png" alt="Xenit logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/Xenit_logo_Vit.png" alt="Xenit logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog/">Blog</a><a href="https://github.com/XenitAB" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2022</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/11/21/golang-memory-dump">Profiling Go in Kubernetes</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/05/04/starboard">Improving XKS security using Starboard</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/2022/04/25/designing-restful-apis-for-cloud-services">Designing RESTful APIs for cloud services</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/04/12/ephemeral-container-security">Kubernetes Ephemeral Container Security</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/02/23/12factor">Twelve-factor app anno 2022</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">Designing RESTful APIs for cloud services</h1><div class="container_mt6G margin-vert--md"><time datetime="2022-04-25T00:00:00.000Z">April 25, 2022</time> · <!-- -->11 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/bittrance" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://media-exp1.licdn.com/dms/image/C5603AQETsc7IPBMeZg/profile-displayphoto-shrink_800_800/0/1516275947412?e=1673481600&amp;v=beta&amp;t=zo3AriMbbg_yN4uAFtsvkSL3aPaGiOl5UZLbCa53WV4" alt="Anders Qvist"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/bittrance" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp" translate="no">Anders Qvist</span></a></div><small class="authorTitle_nd0D" title="Expert Engineer">Expert Engineer</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>HTTP has become the de-facto standard transport protocol for programmatic communication in software-as-a-service offerings. This mostly entails publishing request-response style APIs. We often refer to these APIs as &quot;RESTful APIs&quot;:</p>
<blockquote>
<p><em>[When a] request is made via a RESTful API, [the response is] a representation of the state of the resource[.]</em> -- <a href="https://www.redhat.com/en/topics/api/what-is-a-rest-api" target="_blank" rel="noopener noreferrer" class="">https://www.redhat.com/en/topics/api/what-is-a-rest-api</a></p>
</blockquote>
<p>Let&#x27;s decrypt that: &quot;representation&quot; has come to mean JSON, while &quot;state&quot; refers to those ubiquitous (and unwieldy) relational databases and &quot;resource&quot; is an object from our domain model.</p>
<p>The literature on API design will exhort you to analyze the problem space and consider your design choices carefully. Indeed, design choices will significantly impact the lifecycle of APIs that are part of a software-as-a-service offering. However, when designing a software-as-a-service API, we do not really know the details of future usage. The goal must therefore be to maximize our freedom to evolve the APIs without having to change the formal or informal contracts that regulate their usage. The API should become a facade behind which we are free to evolve the implementation.</p>
<p>This post proposes and motivates a set of guidelines for RESTful APIs (and by extension their contracts) intended to maximize their life span and support rapid evolution throughout it. The post focuses on organizations that want to provide commercial software-as-a-service offerings, though many of the guidelines have wider application.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="start-with-the-basics">Start with the basics<a href="#start-with-the-basics" class="hash-link" aria-label="Direct link to Start with the basics" title="Direct link to Start with the basics" translate="no">​</a></h2>
<p>The guidelines below should be considered in addition to established good practice, so if you are new to REST, you may want to start by reading the literature. Here are some good good articles about RESTful API practices:</p>
<ul>
<li class=""><a href="http://www.restfulwebapis.org/" target="_blank" rel="noopener noreferrer" class="">http://www.restfulwebapis.org/</a></li>
<li class=""><a href="https://restfulapi.net/rest-api-design-tutorial-with-example/" target="_blank" rel="noopener noreferrer" class="">https://restfulapi.net/rest-api-design-tutorial-with-example/</a></li>
<li class=""><a href="https://docs.microsoft.com/en-us/azure/architecture/best-practices/api-design" target="_blank" rel="noopener noreferrer" class="">https://docs.microsoft.com/en-us/azure/architecture/best-practices/api-design</a></li>
</ul>
<p>Note that these articles and the recommendations are not in total harmony, for example when it comes to the extent to which use cases should be allowed to influence API design.</p>
<p>Also, please remember that HTTP is a very rich transport protocol which provides solutions to many common API needs. For example, <a href="https://tools.ietf.org/html/rfc7231#section-5.3" target="_blank" rel="noopener noreferrer" class="">content negotiation</a> and <a href="https://tools.ietf.org/html/rfc7232" target="_blank" rel="noopener noreferrer" class="">conditional requests</a> can help solve various problems.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="practices-for-rapid-evolution">Practices for rapid evolution<a href="#practices-for-rapid-evolution" class="hash-link" aria-label="Direct link to Practices for rapid evolution" title="Direct link to Practices for rapid evolution" translate="no">​</a></h2>
<p>Additionally, there are a number of good practices which are relevant when building software-as-a-service RESTful APIs.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="your-api-is-a-collection-of-nouns">Your API is a collection of nouns<a href="#your-api-is-a-collection-of-nouns" class="hash-link" aria-label="Direct link to Your API is a collection of nouns" title="Direct link to Your API is a collection of nouns" translate="no">​</a></h3>
<p><em>The most central tenet of REST bears repeating: your API is expressed in nouns, each of which is a class of resources. (If expressing your API in terms of nouns feels contrived, you may want to consider an RPC style API instead.) Those resources are queried and manipulated using basic <a href="https://developer.mozilla.org/en-US/docs/Glossary/CRUD" target="_blank" rel="noopener noreferrer" class="">&quot;CRUD&quot;</a> operations. A car sharing service might expose <code>GET /vehicles</code> for finding available vehicles and an individual vehicle would be <code>GET /vehicles/:id</code>.</em></p>
<p><strong>Motivation</strong>: Focusing on resources reduces the risk of implementation details bleeding into the API, which means that it becomes easier to change the backing implementation. This is akin to Kant&#x27;s <a href="https://en.wikipedia.org/wiki/Thing-in-itself" target="_blank" rel="noopener noreferrer" class="">Der ding an sich</a>, in that we are trying to discover what properties a resource should reasonably have to match the sum of all observations.</p>
<p>An important consequence of realizing a service as a series of nouns is that in order to be able to keep to CRUD operations, we may need to introduce new nouns (i.e. sub-resource), for example giving cars &quot;services&quot; so that we have <code>POST /vehicles/:id/services/heater</code> for activating the car&#x27;s heater. With this design, the developer using the API knows that discovery will be <code>GET /vehicles/:id/services</code> and heater status can be checked with <code>GET /vehicles/:id/services/heater</code>. &quot;CRUD plus noun&quot; allows us to builda a contract taxonomy.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="the-caller-is-responsible-for-the-use-case">The caller is responsible for the use case<a href="#the-caller-is-responsible-for-the-use-case" class="hash-link" aria-label="Direct link to The caller is responsible for the use case" title="Direct link to The caller is responsible for the use case" translate="no">​</a></h3>
<p><em>The RESTful API concerns itself with effective access to the data model (the &quot;resources&quot;). Generally speaking, the use case is the caller&#x27;s concern. For example, the caller may be required to combine data from numerous API calls, read more data than it needs and perform its own sorting.</em></p>
<p><strong>Motivation</strong>: An endpoint that is optimized for one use case will be hard pressed to accommodate a second use case. It will be hard to avoid adding a second similar endpoint, risking divergence. Furthermore, use cases will evolve over time and if too much of processing, filtering and sorting quirks is handled by the endpoint, it is very easy to end up in a situation where we have to spend our time optimizing specific database queries for individual use cases rather than improving the performance for all callers by refactoring storage.</p>
<p>Properly implemented RESTful APIs have a good chance of ageing gracefully. By pushing parts of the business logic to the caller (e.g. a batch job or a <a href="https://samnewman.io/patterns/architectural/bff/" target="_blank" rel="noopener noreferrer" class="">backend-for-frontend</a>) it ensures that the RESTful API can be reused across many use cases.</p>
<p>One of the most common mistakes with RESTful APIs is to treat the backend as a layer that translates API calls into SQL. Under this fallacy, as APIs evolve, their queries grow more complex (joining, sorting and complex mutations are common examples) making it ever harder to maintain response times. An extreme version of this is &quot;passthru-sql&quot; (e.g. a query parameter like <code>?filter=&quot;username eq &#x27;bittrance&#x27;&quot;</code>). When developers try to follow the precepts of REST but retain an RPC mindset, they frequently create endpoints that allow the caller to pass query fragments that are appended to the resulting database query more or less verbatim.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="a-published-api-is-an-eternal-promise">A published API is an eternal promise<a href="#a-published-api-is-an-eternal-promise" class="hash-link" aria-label="Direct link to A published API is an eternal promise" title="Direct link to A published API is an eternal promise" translate="no">​</a></h3>
<p><em>As long as we have paying customers on a particular API, we maintain that API. We may refuse access by new customers and we may cancel entire services, but as long as a customer uses a service, all APIs on that service are maintained. Where an API in use needs to be decommissioned, that is a commercial decision.</em></p>
<p><strong>Motivation</strong>: There is no good time to decommission an API. Any change you force on a customer will incur costs for that customer, with limited benefit. Furthermore, in many cases your success will come through partners using your APIs to design new services on top of yours. Adding customers to a well-designed multi-tenant service has very low marginal cost, potentially enabling different business models. Strong sun-setting clauses will constrain our partners&#x27; business models.</p>
<p>You may still want to retain the right to decommission APIs in your contracts; sometimes runaway success may incur unacceptable operational costs and you are forced to redesign. Just be aware that regular use of that clause will damage your reputation. Google Ads ability to <a href="https://developers.google.com/google-ads/api/docs/sunset-dates" target="_blank" rel="noopener noreferrer" class="">regularly decommission</a> their APIs is a strong indicator of its undue marketing power. For a counter-point look at <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-classic-platform.html" target="_blank" rel="noopener noreferrer" class="">retiring EC2 Classic</a>. It took over 10 years from the decision was made to retire EC2 Classic until AWS decided it was commercially acceptable to evict the last stragglers in late 2022.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="endpoints-make-no-assumptions-about-the-url-space">Endpoints make no assumptions about the URL space<a href="#endpoints-make-no-assumptions-about-the-url-space" class="hash-link" aria-label="Direct link to Endpoints make no assumptions about the URL space" title="Direct link to Endpoints make no assumptions about the URL space" translate="no">​</a></h3>
<p><em>We frequently use HTTP load balancers (and API gateways) to compose our URL space. They may direct any arbitrary part of that space to a particular process. Thus, <code>POST /customers</code> may be one service (which writes to the master database) and <code>GET /customers/:id</code> goes to read replica: a particular endpoint or process must not assume that it &quot;owns&quot; the customer resources, for example by assuming that it will see all writes. Similarly, endpoints should minimize the part of the object model that it requires to present its resource. For example, <code>GET /users/:id</code> should not include additional company information in order to be useful, since users and companies may need to be split across different services tomorrow.</em></p>
<p><strong>Motivation</strong>: Our users will be successful by creating innovative things on top of our APIs. Almost by definition, they will use our APIs in ways we did not forsee, thus creating unexpected loads. Therefore, a large part of evolving a cloud service is about changing how data is partitioned and what storage systems are used. Therefore, it is very important to retain flexibility in this regard.</p>
<p>A service typically starts small, as a single process exposing all your endpoints. However, as the service grows in popularity and scope, simple horizontal scaling is often not possible and you need to diversify: you may add new overlapping (micro-)services or you may want to split reads and writes into separate processes (i.e. go <a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/cqrs" target="_blank" rel="noopener noreferrer" class="">CQRS</a>).</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="json-objects-are-maps">JSON objects are maps<a href="#json-objects-are-maps" class="hash-link" aria-label="Direct link to JSON objects are maps" title="Direct link to JSON objects are maps" translate="no">​</a></h3>
<p><em>Adding properties to any returned object is considered a non-breaking change. API docs should point out that properties are new. Similarly, an API can start accepting new optional query parameters on the URL or properties in the input body or add HTTP headers in either direction without being considered breaking.</em></p>
<p><strong>Motivation</strong>: REST fundamentally limits us to CRUD and behavior will be implicit from the resource state. In order to implement new behavior it follows that we will over time introduce new properties which controls that behavior.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="versioning-is-part-of-the-uri">Versioning is part of the URI<a href="#versioning-is-part-of-the-uri" class="hash-link" aria-label="Direct link to Versioning is part of the URI" title="Direct link to Versioning is part of the URI" translate="no">​</a></h3>
<p><em>The URI should contain a version number. In <a href="https://semver.org/" target="_blank" rel="noopener noreferrer" class="">semver</a> terms, this is a &quot;major&quot; version and we use it to signal breaking changes. Given that we have the ability to extend input and output (see <a href="#json-objects-are-maps" class="">JSON objects are maps</a>), it should be possible to accommodate most &quot;minor&quot; changes within existing APIs. Ideally, resources with different versions have an implicit relation. For example, if we serve both <code>GET /v1/customers/acme</code> and <code>GET /v2/customers/acme</code>, they refer to the same customer.</em></p>
<p><strong>Motivation</strong>: Versions in the URI serve two purposes. First, it signals that one resource should be preferred over another. Second, enables us to write new implementations of a service incrementally.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="authorization-is-based-on-method--resource">Authorization is based on method + resource<a href="#authorization-is-based-on-method--resource" class="hash-link" aria-label="Direct link to Authorization is based on method + resource" title="Direct link to Authorization is based on method + resource" translate="no">​</a></h3>
<p><em>Client authorization should depend only on the HTTP request method and the URI (and in some cases on headers). It should preferably not on depend on the request body and particularly not on the state of the resource.</em></p>
<p><strong>Motivation</strong>: Ideally, both authentication and authorization should be handled outside of your endpoint. This may be by middleware in your API or by a load balancer or API gateway. Furthermore, having bespoke authorization logic in your endpoints invites security bugs. It is also hard to document and understand for the caller. Loading the underlying resource to know whether the caller is permitted to perform the request risks being expensive - if you deactivate the caller&#x27;s credentials you don&#x27;t want to continue accruing the cost of those calls (or higher: the client may well retry several times). Finally, filtering lists on permission defeats caching.</p>
<p>A consequence of this rule is that you should avoid APIs that use permissions as filter criteria for resource listings; everyone who calls <code>GET /users</code> should get the same list. If the user list is secret, you introduce a <code>GET /departments/:id/users</code> that has only the relevant users. Similarly, if you have restricted parts of a resource, you can make it into a sub-resource, e.g. <code>GET /users/:id/access_tokens</code>.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="be-tough-on-clients">Be tough on clients<a href="#be-tough-on-clients" class="hash-link" aria-label="Direct link to Be tough on clients" title="Direct link to Be tough on clients" translate="no">​</a></h3>
<p><em>Clients are expected to:</em></p>
<ul>
<li class="">implement HTTP properly. For example, if a resource was missing a correct Content-Type, a client that breaks when this is rectified is at fault.</li>
<li class="">be reasonably parallel. A client should be able to make thousands of requests in a reasonable time frame. For example, a search operation may return summaries and if the client wants more information, it is expected to request the full object for each returned item.</li>
<li class="">do local caching. A client that excessively requests resources that has caching directives should be considered as misbehaving.</li>
</ul>
<p><strong>Motivation</strong>: We are building REST APIs to be used by many different callers and our situation would quickly be untenable if we had to respect quirky clients and inexperienced developers. For example, it is relatively straight-forward to horizontally scale a service that can answer 1 million GET/s, but very tricky to answer one GET request which is supposed to return 1 million entries per second.</p>
<p>Someone may protest that browsers only allow 6-8 concurrent HTTP sessions against one host and that data must therefore be aggregated or pre-processed for clients to be performant. Normally, introducing <a href="https://datatracker.ietf.org/doc/html/rfc7540#section-5" target="_blank" rel="noopener noreferrer" class="">HTTP/2.0 multiplexing</a> and ensuring observed response times of &lt;50ms will do the trick just as well.</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/api">api</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/rest">rest</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/architecture">architecture</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2022/05/04/starboard"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Improving XKS security using Starboard</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/2022/04/12/ephemeral-container-security"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Kubernetes Ephemeral Container Security</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#start-with-the-basics" class="table-of-contents__link toc-highlight">Start with the basics</a></li><li><a href="#practices-for-rapid-evolution" class="table-of-contents__link toc-highlight">Practices for rapid evolution</a><ul><li><a href="#your-api-is-a-collection-of-nouns" class="table-of-contents__link toc-highlight">Your API is a collection of nouns</a></li><li><a href="#the-caller-is-responsible-for-the-use-case" class="table-of-contents__link toc-highlight">The caller is responsible for the use case</a></li><li><a href="#a-published-api-is-an-eternal-promise" class="table-of-contents__link toc-highlight">A published API is an eternal promise</a></li><li><a href="#endpoints-make-no-assumptions-about-the-url-space" class="table-of-contents__link toc-highlight">Endpoints make no assumptions about the URL space</a></li><li><a href="#json-objects-are-maps" class="table-of-contents__link toc-highlight">JSON objects are maps</a></li><li><a href="#versioning-is-part-of-the-uri" class="table-of-contents__link toc-highlight">Versioning is part of the URI</a></li><li><a href="#authorization-is-based-on-method--resource" class="table-of-contents__link toc-highlight">Authorization is based on method + resource</a></li><li><a href="#be-tough-on-clients" class="table-of-contents__link toc-highlight">Be tough on clients</a></li></ul></li></ul></div></div></div></div></div></div>
</body>
</html>